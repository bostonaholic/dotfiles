#!/bin/bash
################################################################################
# Rcopy - Rsync Copy with Progress
#
# DESCRIPTION:
#   Wrapper around rsync for copying files with progress display, statistics,
#   and better performance than standard cp. Shows transfer speed and ETA.
#
# USAGE:
#   rcopy <source> <destination>
#
# ARGUMENTS:
#   source       - Source file or directory
#   destination  - Destination path
#
# EXAMPLES:
#   rcopy /source/directory/ /dest/      # Copy contents only (trailing slash)
#   rcopy /source/directory /dest/       # Copy directory and contents
#   rcopy large_file.iso /backup/        # Copy single file with progress
#
# FEATURES:
#   - Progress bar with percentage and transfer speed
#   - Human-readable statistics
#   - Archive mode (preserves permissions, timestamps, symlinks)
#   - Whole file mode (no delta transfer for local copies)
#   - In-place updates
#
# NOTES:
#   Trailing slash on source matters (copies contents vs. directory itself).
#   Much faster than cp for large files and directories.
#
# SOURCE:
#   https://apple.stackexchange.com/questions/32785
#
################################################################################

set -eu -o pipefail

rsync --verbose \
      --archive \
      --whole-file \
      --inplace \
      --bwlimit=0 \
      --progress \
      --stats \
      --human-readable \
      "$@"
