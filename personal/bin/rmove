#!/bin/bash
################################################################################
# Rmove - Rsync Move with Progress
#
# DESCRIPTION:
#   Wrapper around rsync for moving files with progress display. Like rcopy
#   but removes source files after successful transfer (move instead of copy).
#
# USAGE:
#   rmove <source> <destination>
#
# ARGUMENTS:
#   source       - Source file or directory
#   destination  - Destination path
#
# EXAMPLES:
#   rmove /source/directory/ /dest/      # Move contents only (trailing slash)
#   rmove /source/directory /dest/       # Move directory and contents
#   rmove large_file.iso /backup/        # Move single file with progress
#
# FEATURES:
#   - Progress bar with percentage and transfer speed
#   - Human-readable statistics
#   - Archive mode (preserves permissions, timestamps, symlinks)
#   - Removes source files after successful transfer
#   - Whole file mode with in-place updates
#
# NOTES:
#   Trailing slash on source matters (moves contents vs. directory itself).
#   Source files deleted only after successful transfer.
#   For cross-filesystem moves, much more efficient than mv.
#
# SOURCE:
#   https://apple.stackexchange.com/questions/32785
#
################################################################################

set -eu -o pipefail

rsync --verbose \
      --archive \
      --whole-file \
      --inplace \
      --bwlimit=0 \
      --progress \
      --stats \
      --human-readable \
      --remove-source-files \
      "$@"
